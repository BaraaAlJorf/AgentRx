--- Arguments Loaded ---
{
    "output_dir": "./results/QWEN-COT-SC",
    "agent_setup": "SingleAgent-CoT-SC",
    "seed": 42,
    "batch_size": 8,
    "num_workers": 4,
    "model_id": "Qwen/Qwen2.5-VL-7B-Instruct",
    "max_new_tokens": 128,
    "data_path": "/scratch/baj321/MedAgent/datasets/multimodal_dataset_splits/test.jsonl",
    "few_shot_data_path": "/scratch/baj321/MedAgent/datasets/multimodal_dataset_splits/train.jsonl",
    "consistency_samples": 5,
    "num_shots": 2,
    "modalities": "ps",
    "load_cxr": null,
    "load_ehr": null,
    "load_rr": null,
    "ablation": null,
    "normalizer_state": null,
    "ehr_data_dir": "/scratch/fs999/shamoutlab/data/mimic-iv-extracted",
    "cxr_data_dir": "/scratch/fs999/shamoutlab/data/physionet.org/files/mimic-cxr-jpg/2.0.0",
    "debug_samples": 2
}
--------------------------
Random seed set to: 42
Results will be saved to: ./results/QWEN-COT-SC

[Status] Initializing Data Loader from: /scratch/baj321/MedAgent/datasets/multimodal_dataset_splits/test.jsonl

[Pre-Loading] Initializing parallel workers (4) to load data into RAM...
[Pre-Loading] Successfully loaded 4925 samples into RAM.

Starting simulation with agent setup: 'SingleAgent-CoT-SC'...
Initializing Model and Processor for 'Qwen/Qwen2.5-VL-7B-Instruct'...
⚡ Applying Left-Padding fix for Qwen...
Loading Qwen/Qwen2.5-VL-7B-Instruct as Qwen2_5_VLForConditionalGeneration...
✅ Using Token IDs - Yes: 9454, No: 2753
✅ Model loaded successfully.
   [Self-Consistency] Sampling 5 CoT paths per patient...
